<UserControl x:Class="GCS.Views.MessagesTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="500" d:DesignWidth="480">
    
    <UserControl.Resources>
        <SolidColorBrush x:Key="CardBackground" Color="#1C2128"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#2D333D"/>
        <SolidColorBrush x:Key="PrimaryText" Color="#E6EDF3"/>
        <SolidColorBrush x:Key="SecondaryText" Color="#8B949E"/>
        <SolidColorBrush x:Key="AccentGreen" Color="#3FB950"/>
        <SolidColorBrush x:Key="AccentOrange" Color="#FF9500"/>
        <SolidColorBrush x:Key="AccentRed" Color="#F85149"/>
    </UserControl.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0"
                Background="{StaticResource CardBackground}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="6"
                Padding="12"
                Margin="5,5,5,10">
            <Grid>
                <TextBlock Text="MAVLINK MESSAGES" 
                          Foreground="{StaticResource SecondaryText}"
                          FontSize="11"
                          FontWeight="Bold"
                          VerticalAlignment="Center"/>
                
                <Button Content="CLEAR"
                       HorizontalAlignment="Right"
                       Padding="12,6"
                       Background="#0A0E14"
                       Foreground="{StaticResource PrimaryText}"
                       BorderBrush="{StaticResource BorderBrush}"
                       BorderThickness="1"
                       FontSize="10"
                       FontWeight="Bold"
                       Cursor="Hand"
                       Command="{Binding ClearCommand}">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{StaticResource BorderBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </Grid>
        </Border>
        
        <!-- Messages List - Bound to Messages collection -->
        <ScrollViewer Grid.Row="1" 
                     VerticalScrollBarVisibility="Auto"
                     Margin="5">
            <ItemsControl ItemsSource="{Binding Messages}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="{StaticResource CardBackground}"
                                BorderThickness="1"
                                CornerRadius="4"
                                Padding="10"
                                Margin="0,0,0,5">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Setter Property="BorderBrush" Value="{StaticResource AccentGreen}"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SeverityText}" Value="WARN">
                                            <Setter Property="BorderBrush" Value="{StaticResource AccentOrange}"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding SeverityText}" Value="ERR">
                                            <Setter Property="BorderBrush" Value="{StaticResource AccentRed}"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding SeverityText}" Value="CRIT">
                                            <Setter Property="BorderBrush" Value="{StaticResource AccentRed}"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Timestamp -->
                                <TextBlock Grid.Column="0"
                                          Text="{Binding Timestamp}"
                                          Foreground="{StaticResource SecondaryText}"
                                          FontSize="10"
                                          FontFamily="Consolas"
                                          Margin="0,0,12,0"
                                          VerticalAlignment="Center"/>
                                
                                <!-- Severity Badge -->
                                <Border Grid.Column="1"
                                        CornerRadius="3"
                                        Padding="6,2"
                                        Margin="0,0,10,0"
                                        VerticalAlignment="Center">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="{StaticResource AccentGreen}"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SeverityText}" Value="WARN">
                                                    <Setter Property="Background" Value="{StaticResource AccentOrange}"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding SeverityText}" Value="ERR">
                                                    <Setter Property="Background" Value="{StaticResource AccentRed}"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding SeverityText}" Value="CRIT">
                                                    <Setter Property="Background" Value="{StaticResource AccentRed}"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock Text="{Binding SeverityText}"
                                              Foreground="White"
                                              FontSize="9"
                                              FontWeight="Bold"/>
                                </Border>
                                
                                <!-- Message Text -->
                                <TextBlock Grid.Column="2"
                                          Text="{Binding Text}"
                                          Foreground="{StaticResource PrimaryText}"
                                          FontSize="11"
                                          TextWrapping="Wrap"
                                          VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</UserControl>
